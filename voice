import React, { useState, useEffect } from 'react';
import { Calendar, CheckCircle2, Circle, Star, Book, Mic, Heart, TrendingUp, Award, Volume2, Wind, MessageCircle, Sparkles } from 'lucide-react';

const VoiceTrainingTracker = () => {
  const [currentPhase, setCurrentPhase] = useState(1);
  const [dayInPhase, setDayInPhase] = useState(1);
  const [completedToday, setCompletedToday] = useState({
    warmup: false,
    technique: false,
    application: false,
    cooldown: false
  });
  const [dailyNote, setDailyNote] = useState('');
  const [strainLevel, setStrainLevel] = useState(0);
  const [showCelebration, setShowCelebration] = useState(false);
  const [totalDays, setTotalDays] = useState(1);
  const [currentView, setCurrentView] = useState('today');

  const phases = {
    1: { name: 'Foundation & Building Stamina', weeks: '1-2', duration: '10-15 min', days: 14 },
    2: { name: 'Expanding Practice', weeks: '3-4', duration: '20-30 min', days: 14 },
    3: { name: 'Integration & Refinement', weeks: '5-8', duration: '35-45 min', days: 28 },
    4: { name: 'Maintenance & Mastery', weeks: 'Ongoing', duration: '45 min', days: 999 }
  };

  const exercises = {
    1: {
      warmup: [
        { exercise: 'Diaphragmatic breathing (2 min)', description: 'Breathe deeply from your belly, not your chest. Hand on stomach should rise and fall.' },
        { exercise: 'Gentle humming scales (3 min)', description: 'Hum up and down your comfortable range softly. Feel the vibration in your face.' },
        { exercise: 'Lip trills and sirens (3 min)', description: 'Make "brrrr" sounds sliding up and down. Loosens lips and warms vocal cords gently.' },
        { exercise: 'Jaw and tongue stretches (2 min)', description: 'Open jaw wide, move it side to side. Stick tongue out and move it around. Releases tension.' }
      ],
      technique: [
        { exercise: 'Breath support exercises (5 min)', description: 'Practice controlling airflow with "sss" sounds. Strong, steady breath supports better voice control.' },
        { exercise: 'Sustained "hmmm" for resonance (5 min)', description: 'Hold a hum and feel where it vibrates. Try moving the feeling higher in your face/nose.' },
        { exercise: 'Listening to voice models (5 min)', description: 'Pick one creator and really listen. Notice pitch, melody, pacing, and energy of their speech.' }
      ],
      application: [
        { exercise: 'Read aloud softly (5 min)', description: 'Read a few paragraphs focusing on breath and staying relaxed. Don\'t push for "the voice" yet.' },
        { exercise: 'Practice single sentences with focus (5 min)', description: 'Pick 3-5 simple sentences. Repeat each one, trying slight variations in pitch or resonance.' }
      ],
      cooldown: [
        { exercise: 'Gentle humming down', description: 'Hum slowly down to your lowest comfortable pitch. Helps relax the voice.' },
        { exercise: 'Hydrate', description: 'Drink water! Vocal cords need moisture to stay healthy and flexible.' },
        { exercise: 'Note any strain or discoveries', description: 'What felt good? What hurt? What surprised you? Write it down in your reflection.' }
      ]
    },
    2: {
      warmup: [
        { exercise: 'Diaphragmatic breathing (2 min)', description: 'Deep belly breaths. Make sure shoulders stay relaxed and still.' },
        { exercise: 'Humming scales with focus (3 min)', description: 'Hum scales while focusing on keeping resonance bright and forward in your face.' },
        { exercise: 'Sirens exploring range (3 min)', description: 'Slide through your full range on "ng" or hum. Find where your voice feels most comfortable.' },
        { exercise: 'Resonance placement hums (2 min)', description: 'Hum and alternate focusing vibration in chest vs. nose/face. Notice the difference in sound.' }
      ],
      technique: [
        { exercise: 'Pitch glides and holding (7 min)', description: 'Glide to target pitch on "ah", hold it steady. Practice finding and maintaining your goal pitch.' },
        { exercise: 'Resonance exercises - bright vs dark (7 min)', description: 'Say vowels with chest resonance (dark) then face resonance (bright). Feel the difference.' },
        { exercise: 'Intonation patterns practice (6 min)', description: 'Practice making your voice go up at end of questions, down for statements. Exaggerate the melody.' },
        { exercise: 'Mimicking voice model phrases (5 min)', description: 'Pick a short phrase from your model. Try to match their exact melody and rhythm.' }
      ],
      application: [
        { exercise: 'Reading with intention (7 min)', description: 'Read with emotional expression. Let your voice rise and fall naturally with the meaning.' },
        { exercise: 'Practice common phrases (5 min)', description: 'Repeat everyday phrases ("How are you?", "That sounds great!") with your new techniques.' },
        { exercise: 'Record short samples (3 min)', description: 'Record yourself reading or talking. Don\'t judge, just capture where you are today.' }
      ],
      cooldown: [
        { exercise: 'Descending hums', description: 'Hum from high to low, releasing tension as you go down.' },
        { exercise: 'Vocal rest posture', description: 'Sit or stand with good posture, breathe naturally, let your voice rest completely.' },
        { exercise: 'Journal observations', description: 'What\'s getting easier? What\'s still challenging? Track patterns over time.' }
      ]
    },
    3: {
      warmup: [
        { exercise: 'Full breathing routine (3 min)', description: 'Complete breath work: belly breathing, breath holds, controlled exhales. Build stamina.' },
        { exercise: 'Resonance warm-up (3 min)', description: 'Hum, then add vowels while maintaining forward, bright resonance. Feel it in your mask.' },
        { exercise: 'Range exploration (4 min)', description: 'Explore your full range with scales, glides, and sustained notes at different pitches.' }
      ],
      technique: [
        { exercise: 'Pitch control exercises (8 min)', description: 'Hit specific target pitches and hold them steady while speaking words and phrases.' },
        { exercise: 'Speech melody patterns (8 min)', description: 'Practice the musicality of sentences: rising questions, falling statements, emphasis patterns.' },
        { exercise: 'Conversational flow practice (7 min)', description: 'Speak in longer conversational chunks. Focus on maintaining techniques while sounding natural.' },
        { exercise: 'Difficult sound combos (5 min)', description: 'Practice words/sounds that make you slip back to old patterns. Repetition builds new habits.' }
      ],
      application: [
        { exercise: 'Read varied content (8 min)', description: 'Read different types of text: news, stories, dialogue. Adapt your voice to the content.' },
        { exercise: 'Simulate conversations (10 min)', description: 'Have imaginary conversations or answer pretend questions. Practice spontaneous speech.' },
        { exercise: 'Listen back to recordings (5 min)', description: 'Listen to your recent recordings. Notice improvements and areas to focus on.' }
      ],
      cooldown: [
        { exercise: 'Voice massage techniques', description: 'Gently massage your throat, jaw, and neck. Release any accumulated tension.' },
        { exercise: 'Reflection on naturalness', description: 'How natural did your voice feel today? The goal is comfort, not perfection.' },
        { exercise: 'Celebrate progress', description: 'Acknowledge something you did well today, even if small. Progress isn\'t always linear.' }
      ]
    },
    4: {
      warmup: [
        { exercise: 'Comprehensive warm-up routine (5 min)', description: 'Your personal warm-up combining breathing, humming, range work, and resonance focus.' }
      ],
      technique: [
        { exercise: 'Maintenance of all skills (20 min)', description: 'Run through pitch, resonance, intonation, and breath work. Keep all skills sharp.' },
        { exercise: 'Challenging material practice (10 min)', description: 'Read difficult passages, practice challenging conversations, push your comfort zone.' },
        { exercise: 'Fine-tuning specific areas (10 min)', description: 'Focus on whatever needs work: maybe certain sounds, maintaining pitch, or natural flow.' }
      ],
      application: [
        { exercise: 'Real-world application (15 min)', description: 'Use your voice in real scenarios: phone calls, voice messages, or safe in-person practice.' },
        { exercise: 'Recording and analysis (10 min)', description: 'Record longer samples, compare to older recordings, analyze what\'s working and what to refine.' }
      ],
      cooldown: [
        { exercise: 'Full cool-down and reflection', description: 'Complete vocal rest routine, hydration, and thoughtful reflection on your ongoing journey.' }
      ]
    }
  };

  const milestones = [
    { day: 7, title: 'One Week Strong!', message: 'You showed up for yourself every day this week. That consistency is everything! üåü' },
    { day: 14, title: 'Foundation Complete!', message: 'You\'ve built the habit and learned the basics. Ready for Phase 2! üéâ' },
    { day: 21, title: 'Three Weeks In!', message: 'Your voice is already changing. Can you hear it? Keep going! üí™' },
    { day: 28, title: 'One Month Milestone!', message: 'A full month of dedication! You\'re doing amazing work. üèÜ' },
    { day: 42, title: 'Phase 2 Complete!', message: 'Your techniques are getting stronger. Time to integrate! üöÄ' },
    { day: 56, title: 'Eight Weeks!', message: 'Two months of growth and learning. You should be proud! ‚≠ê' },
    { day: 70, title: 'Phase 3 Complete!', message: 'You\'re integrating your voice naturally now. Beautiful! üåà' },
    { day: 100, title: '100 Days of Voice!', message: 'ONE HUNDRED DAYS! This is monumental. Your voice is truly yours! üéä' }
  ];

  const voiceModels = [
    {
      name: 'TransVoiceLessons (Zhea)',
      platform: 'YouTube',
      description: 'Comprehensive trans voice training with scientific approach. Excellent for understanding mechanics.',
      link: 'Search: TransVoiceLessons YouTube'
    },
    {
      name: 'Zoey Alexandria',
      platform: 'YouTube',
      description: 'Clear, methodical lessons focusing on resonance and practical exercises.',
      link: 'Search: Zoey Alexandria voice training'
    },
    {
      name: 'Seattle Voice Lab',
      platform: 'YouTube',
      description: 'Professional voice feminization content with detailed technique breakdowns.',
      link: 'Search: Seattle Voice Lab'
    },
    {
      name: 'Nicole Windy Wick',
      platform: 'YouTube/TikTok',
      description: 'Quick tips and demonstrations with an encouraging approach.',
      link: 'Search: Nicole Windy Wick voice'
    },
    {
      name: 'Clover',
      platform: 'YouTube',
      description: 'Trans voice content creator with practical everyday examples.',
      link: 'Search: Clover trans voice'
    }
  ];

  const tips = [
    'Hydration is key! Keep water nearby during practice.',
    'If you feel strain, stop immediately. Rest is productive too.',
    'Recording yourself helps track progress you might not hear in the moment.',
    'Practice in private first, then gradually in comfortable settings.',
    'Your voice may sound different to you than to others - that\'s normal!',
    'Consistency beats intensity. Small daily practice > occasional long sessions.',
    'Some days will feel like regression - that\'s part of learning.',
    'Celebrate small wins! Every step forward matters.',
    'Your voice is valid at every stage of this journey.',
    'Take breaks between exercises to avoid fatigue.'
  ];

  const checkMilestone = (day) => {
    const milestone = milestones.find(m => m.day === day);
    if (milestone && !showCelebration) {
      setShowCelebration(milestone);
    }
  };

  const completeExercise = (type) => {
    const newCompleted = { ...completedToday, [type]: !completedToday[type] };
    setCompletedToday(newCompleted);
    
    if (Object.values(newCompleted).every(v => v)) {
      setTimeout(() => checkMilestone(totalDays), 500);
    }
  };

  const advanceDay = () => {
    if (Object.values(completedToday).every(v => v)) {
      const newTotalDays = totalDays + 1;
      setTotalDays(newTotalDays);
      
      const newDayInPhase = dayInPhase + 1;
      if (newDayInPhase > phases[currentPhase].days && currentPhase < 4) {
        setCurrentPhase(currentPhase + 1);
        setDayInPhase(1);
      } else {
        setDayInPhase(newDayInPhase);
      }
      
      setCompletedToday({ warmup: false, technique: false, application: false, cooldown: false });
      setDailyNote('');
      setStrainLevel(0);
      checkMilestone(newTotalDays);
    }
  };

  const ExerciseSection = ({ title, type, icon: Icon, exercises }) => (
    <div className="mb-6 bg-white rounded-lg shadow-sm border-2 border-purple-100 p-4">
      <div className="flex items-center justify-between mb-3">
        <div className="flex items-center gap-2">
          <Icon className="text-purple-500" size={20} />
          <h3 className="font-semibold text-gray-800">{title}</h3>
        </div>
        <button
          onClick={() => completeExercise(type)}
          className={`flex items-center gap-1 px-3 py-1 rounded-full text-sm font-medium transition-all ${
            completedToday[type]
              ? 'bg-green-500 text-white'
              : 'bg-gray-200 text-gray-600 hover:bg-purple-100'
          }`}
        >
          {completedToday[type] ? <CheckCircle2 size={16} /> : <Circle size={16} />}
          {completedToday[type] ? 'Done!' : 'Mark Complete'}
        </button>
      </div>
      <ul className="space-y-2">
        {exercises.map((item, idx) => (
          <li key={idx} className="text-gray-700">
            <div className="flex items-start gap-2">
              <span className="text-purple-400 mt-1">‚Ä¢</span>
              <div className="flex-1">
                <div className="font-medium">{item.exercise}</div>
                <div className="text-sm text-gray-600 mt-1">{item.description}</div>
              </div>
            </div>
          </li>
        ))}
      </ul>
    </div>
  );

  return (
    <div className="min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 p-4">
      <div className="max-w-4xl mx-auto">
        {/* Header */}
        <div className="bg-white rounded-xl shadow-lg p-6 mb-6">
          <div className="flex items-center justify-between mb-4">
            <div>
              <h1 className="text-3xl font-bold text-gray-800 mb-1">Voice Training Journey</h1>
              <p className="text-gray-600">Your voice, your way ‚ú®</p>
            </div>
            <div className="text-right">
              <div className="text-3xl font-bold text-purple-600">{totalDays}</div>
              <div className="text-sm text-gray-600">days strong</div>
            </div>
          </div>
          
          {/* Phase Progress */}
          <div className="bg-gradient-to-r from-purple-100 to-pink-100 rounded-lg p-4">
            <div className="flex items-center justify-between mb-2">
              <div>
                <div className="text-sm font-medium text-purple-800">Phase {currentPhase}</div>
                <div className="font-semibold text-gray-800">{phases[currentPhase].name}</div>
              </div>
              <div className="text-right">
                <div className="text-sm text-gray-600">Weeks {phases[currentPhase].weeks}</div>
                <div className="font-medium text-purple-600">{phases[currentPhase].duration}/day</div>
              </div>
            </div>
            <div className="bg-white rounded-full h-2 overflow-hidden">
              <div 
                className="bg-gradient-to-r from-purple-500 to-pink-500 h-full transition-all duration-500"
                style={{ width: `${(dayInPhase / phases[currentPhase].days) * 100}%` }}
              />
            </div>
            <div className="text-xs text-gray-600 mt-1 text-right">
              Day {dayInPhase} of {phases[currentPhase].days === 999 ? 'ongoing' : phases[currentPhase].days}
            </div>
          </div>
        </div>

        {/* Navigation */}
        <div className="flex gap-2 mb-6">
          {['today', 'resources', 'progress'].map(view => (
            <button
              key={view}
              onClick={() => setCurrentView(view)}
              className={`flex-1 py-2 px-4 rounded-lg font-medium transition-all ${
                currentView === view
                  ? 'bg-purple-600 text-white shadow-md'
                  : 'bg-white text-gray-600 hover:bg-purple-50'
              }`}
            >
              {view === 'today' && 'üìÖ Today\'s Practice'}
              {view === 'resources' && 'üìö Resources'}
              {view === 'progress' && 'üìà Progress'}
            </button>
          ))}
        </div>

        {/* Today's Practice View */}
        {currentView === 'today' && (
          <div>
            {/* Today's tip */}
            <div className="bg-blue-50 border-l-4 border-blue-400 rounded-lg p-4 mb-6">
              <div className="flex items-start gap-3">
                <Sparkles className="text-blue-500 mt-1" size={20} />
                <div>
                  <div className="font-semibold text-blue-900 mb-1">Today's Tip</div>
                  <p className="text-blue-800">{tips[totalDays % tips.length]}</p>
                </div>
              </div>
            </div>

            {/* Exercise sections */}
            <ExerciseSection 
              title="Warm-Up" 
              type="warmup" 
              icon={Wind}
              exercises={exercises[currentPhase].warmup}
            />
            
            <ExerciseSection 
              title="Technique Work" 
              type="technique" 
              icon={Mic}
              exercises={exercises[currentPhase].technique}
            />
            
            <ExerciseSection 
              title="Application Practice" 
              type="application" 
              icon={MessageCircle}
              exercises={exercises[currentPhase].application}
            />
            
            <ExerciseSection 
              title="Cool-Down & Reflection" 
              type="cooldown" 
              icon={Heart}
              exercises={exercises[currentPhase].cooldown}
            />

            {/* Strain Check */}
            <div className="bg-white rounded-lg shadow-sm border-2 border-yellow-100 p-4 mb-6">
              <h3 className="font-semibold text-gray-800 mb-3 flex items-center gap-2">
                <Volume2 className="text-yellow-500" size={20} />
                Strain Level Check
              </h3>
              <p className="text-sm text-gray-600 mb-3">How does your voice feel? (0 = great, 5 = strained)</p>
              <div className="flex gap-2">
                {[0, 1, 2, 3, 4, 5].map(level => (
                  <button
                    key={level}
                    onClick={() => setStrainLevel(level)}
                    className={`flex-1 py-2 rounded-lg font-medium transition-all ${
                      strainLevel === level
                        ? level <= 2 ? 'bg-green-500 text-white' : level === 3 ? 'bg-yellow-500 text-white' : 'bg-red-500 text-white'
                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                    }`}
                  >
                    {level}
                  </button>
                ))}
              </div>
              {strainLevel >= 4 && (
                <div className="mt-3 p-3 bg-red-50 rounded text-sm text-red-800">
                  ‚ö†Ô∏è Take a break! Vocal strain can cause damage. Rest and hydrate.
                </div>
              )}
            </div>

            {/* Daily Note */}
            <div className="bg-white rounded-lg shadow-sm border-2 border-purple-100 p-4 mb-6">
              <h3 className="font-semibold text-gray-800 mb-3">Daily Reflection</h3>
              <textarea
                value={dailyNote}
                onChange={(e) => setDailyNote(e.target.value)}
                placeholder="What did you notice today? Any breakthroughs or challenges?"
                className="w-full p-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300"
                rows="4"
              />
            </div>

            {/* Complete Day Button */}
            {Object.values(completedToday).every(v => v) && (
              <button
                onClick={advanceDay}
                className="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 rounded-lg font-semibold text-lg shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2"
              >
                <Star size={24} />
                Complete Day {totalDays}!
              </button>
            )}
          </div>
        )}

        {/* Resources View */}
        {currentView === 'resources' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <Book className="text-purple-600" />
                Voice Models & Educators
              </h2>
              <p className="text-gray-600 mb-6">
                These creators have extensive public content to help you learn. Listen to their voices, study their patterns, and find someone whose voice resonates with your goals.
              </p>
              <div className="space-y-4">
                {voiceModels.map((model, idx) => (
                  <div key={idx} className="border border-purple-100 rounded-lg p-4 hover:bg-purple-50 transition-all">
                    <div className="flex items-start justify-between mb-2">
                      <h3 className="font-semibold text-gray-800">{model.name}</h3>
                      <span className="text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded">{model.platform}</span>
                    </div>
                    <p className="text-sm text-gray-600 mb-2">{model.description}</p>
                    <div className="text-xs text-purple-600 font-medium">{model.link}</div>
                  </div>
                ))}
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-4">Key Concepts</h2>
              <div className="space-y-3 text-gray-700">
                <div>
                  <h3 className="font-semibold text-purple-700 mb-1">Resonance</h3>
                  <p className="text-sm">Where your voice resonates in your body affects how it sounds. Raising resonance (oral/nasal vs chest) is often more impactful than pitch alone.</p>
                </div>
                <div>
                  <h3 className="font-semibold text-purple-700 mb-1">Pitch</h3>
                  <p className="text-sm">The musical note of your voice. Most feminine voices sit around 180-220 Hz, but natural variation is key.</p>
                </div>
                <div>
                  <h3 className="font-semibold text-purple-700 mb-1">Intonation</h3>
                  <p className="text-sm">The melody of speech - how your pitch moves through sentences. Often more gendered than base pitch.</p>
                </div>
                <div>
                  <h3 className="font-semibold text-purple-700 mb-1">Speech Patterns</h3>
                  <p className="text-sm">Rhythm, pacing, word choices, and conversational style all contribute to voice presentation.</p>
                </div>
              </div>
            </div>
          </div>
        )}

        {/* Progress View */}
        {currentView === 'progress' && (
          <div className="space-y-6">
            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <TrendingUp className="text-purple-600" />
                Your Progress
              </h2>
              <div className="grid grid-cols-2 gap-4 mb-6">
                <div className="bg-purple-50 rounded-lg p-4 text-center">
                  <div className="text-3xl font-bold text-purple-600">{totalDays}</div>
                  <div className="text-sm text-gray-600">Days Practiced</div>
                </div>
                <div className="bg-pink-50 rounded-lg p-4 text-center">
                  <div className="text-3xl font-bold text-pink-600">{currentPhase}</div>
                  <div className="text-sm text-gray-600">Current Phase</div>
                </div>
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-lg p-6">
              <h2 className="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                <Award className="text-yellow-500" />
                Milestones
              </h2>
              <div className="space-y-3">
                {milestones.map((milestone, idx) => {
                  const achieved = totalDays >= milestone.day;
                  return (
                    <div
                      key={idx}
                      className={`border-2 rounded-lg p-4 transition-all ${
                        achieved
                          ? 'border-yellow-300 bg-yellow-50'
                          : 'border-gray-200 bg-gray-50 opacity-50'
                      }`}
                    >
                      <div className="flex items-start gap-3">
                        <div className={`mt-1 ${achieved ? 'text-yellow-500' : 'text-gray-400'}`}>
                          {achieved ? <Star size={24} fill="currentColor" /> : <Star size={24} />}
                        </div>
                        <div className="flex-1">
                          <div className="font-semibold text-gray-800">{milestone.title}</div>
                          <div className="text-sm text-gray-600">Day {milestone.day}</div>
                          {achieved && (
                            <div className="text-sm text-gray-700 mt-1">{milestone.message}</div>
                          )}
                        </div>
                      </div>
                    </div>
                  );
                })}
              </div>
            </div>
          </div>
        )}
      </div>

      {/* Celebration Modal */}
      {showCelebration && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50">
          <div className="bg-white rounded-2xl shadow-2xl max-w-md w-full p-8 text-center animate-bounce">
            <div className="text-6xl mb-4">üéâ</div>
            <h2 className="text-3xl font-bold text-purple-600 mb-2">{showCelebration.title}</h2>
            <p className="text-gray-700 text-lg mb-6">{showCelebration.message}</p>
            <button
              onClick={() => setShowCelebration(false)}
              className="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-lg font-semibold hover:shadow-lg transition-all"
            >
              Thank you! üíú
            </button>
          </div>
        </div>
      )}
    </div>
  );
};

export default VoiceTrainingTracker;
